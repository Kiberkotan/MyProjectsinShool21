# Задание №2. Архитектура
__Архитектура веб-приложений__ — это план одновременных взаимодействий между компонентами, базами данных, промежуточными системами, пользовательскими интерфейсами и серверами в приложении. Его также можно описать как макет, который логически определяет соединение между сервером и клиентской частью для лучшего взаимодействия с Интернетом.   
Все приложения состоят из двух основных компонентов:  
•	Сторона клиента, обычно называемая: интерфейс, где код написан на HTML, CSS, JavaScript и хранится в браузере. Именно здесь происходит взаимодействие с пользователем.  
•	Серверная часть, также известная как бэкэнд, управляет бизнес-логикой и отвечает на HTTP-запросы. Серверный код написан на Java, PHP, Ruby, Python и т. д.  
Помимо этого, есть дополнительный компонент — сервер базы данных, который отправляет запрошенные данные на сторону сервера.
## Уровни веб-приложения
Современные веб-приложения имеют многоуровневую архитектуру, состоящую из уровней представления, бизнеса, сохранения и базы данных. Небольшие приложения имеют три уровня, где в некоторых случаях бизнес-уровни и уровни сохраняемости действуют вместе, а сложные приложения имеют пять или шесть уровней.
1.	__Уровень представления__, построенный с помощью HTML, CSS, JavaScript и их фреймворков, обеспечивает связь между интерфейсом и браузером для облегчения взаимодействия с пользователем.
2.	__Бизнес-уровень__ определяет бизнес-логику и правила. Он обрабатывает запросы браузера, выполняет бизнес-логику, связанную с запросами, а затем отправляет их на уровень представления.
3.	__Уровень сохраняемости__ отвечает за доступ к данным. Он тесно связан с бизнес-уровнем и имеет сервер базы данных, который извлекает данные с соответствующих серверов.
4.	__Уровень базы данных или уровень службы данных__ содержит все данные и обеспечивает безопасность данных, отделяя бизнес-логику от клиентской стороны.
Каждый из этих слоев работает независимо от другого. Компоненты одного слоя закрыты и имеют дело с логикой связанного слоя.  Например, компоненты, находящиеся на уровне представления, имеют дело с логикой представления, а компоненты бизнес-уровня — с бизнес-логикой. Такая схема работы снижает потенциальную нагрузку, когда в веб-приложении требуются изменения. Поэтому изменения могут быть внесены в один слой, не затрагивая компоненты других слоев.
## Монолитная и микросервисная архитектура
__Монолитная архитектура__ — это традиционная модель программного обеспечения, которая представляет собой единый модуль, работающий автономно и независимо от других приложений.  
Монолитом часто называют нечто большое и неповоротливое, и эти два слова хорошо описывают монолитную архитектуру для проектирования ПО.  
Монолитная архитектура — это отдельная большая вычислительная сеть с единой базой кода, в которой объединены все бизнес-задачи. Чтобы внести изменения в такое приложение, необходимо обновить весь стек через базу кода, а также создать и развернуть обновленную версию интерфейса, находящегося на стороне службы. Это ограничивает работу с обновлениями и требует много времени.  
Монолиты удобно использовать на начальных этапах проектов, чтобы облегчить развертывание и не тратить слишком много умственных усилий при управлении кодом. Это позволяет сразу выпускать все, что есть в монолитном приложении.
### Преимущества монолитной архитектуры
Организации могут извлечь выгоду как из монолитной архитектуры, так и из микросервисной в зависимости от ряда различных факторов.  
При использовании монолитной архитектуры удобно создавать приложения на основе одной базы кода, поэтому ее основное преимущество заключается в быстроте разработки.  
К преимуществам монолитной архитектуры можно отнести следующие особенности.
•	Простое развертывание. Использование одного исполняемого файла или каталога упрощает развертывание.  
•	Разработка. Приложение легче разрабатывать, когда оно создано с использованием одной базы кода.  
•	Производительность. В централизованной базе кода и репозитории один интерфейс API часто может выполнять ту функцию, которую при работе с микросервисами выполняют многочисленные API.  
•	Упрощенное тестирование. Монолитное приложение представляет собой единый централизованный модуль, поэтому сквозное тестирование можно проводить быстрее, чем при использовании распределенного приложения.  
•	Удобная отладка. Весь код находится в одном месте, благодаря чему становится легче выполнять запросы и находить проблемы.

### Недостатки монолитной архитектуры
Монолитные приложения работают достаточно эффективно до тех пор, пока они не становятся слишком большими и не вызывают проблем с масштабированием.  
Чтобы внести небольшое изменение в одну функцию, необходимо выполнить компиляцию и тестирование всей платформы, что противоречит agile-подходу, которому отдают предпочтение современные разработчики.  
К недостаткам монолитной архитектуры можно отнести следующие особенности.  
•	Снижение скорости разработки. Большое монолитное приложение усложняет и замедляет разработку.  
•	Масштабируемость. Невозможно масштабировать отдельные компоненты.  
•	Надежность. Ошибка в одном модуле может повлиять на доступность всего приложения.  
•	Препятствия для внедрения технологий. Любые изменения в инфраструктуре или языке разработки влияют на приложение целиком, что зачастую приводит к увеличению стоимости и временных затрат.  
•	Недостаточная гибкость. Возможности монолитных приложений ограничены используемыми технологиями.  
•	Развертывание. При внесении небольшого изменения потребуется повторное развертывание всего монолитного приложения.

## Что такое микросервисы?
__Микросервисная архитектура__ (или просто «микросервисы») представляет собой метод организации архитектуры, основанный на ряде независимо развертываемых служб. У этих служб есть собственная бизнес-логика и база данных с конкретной целью. Обновление, тестирование, развертывание и масштабирование выполняются внутри каждой службы.  
Микросервисы разбивают крупные задачи, характерные для конкретного бизнеса, на несколько независимых баз кода. Микросервисы не снижают сложность, но они делают любую сложность видимой и более управляемой, разделяя задачи на более мелкие процессы, которые функционируют независимо друг от друга и вносят вклад в общее целое.

### Преимущества микросервисов
Микросервисы не являются волшебной палочкой, но они решают ряд проблем, с которыми сталкиваются растущие компании при развитии ПО.  
Поскольку архитектура микросервисов состоит из независимо работающих модулей, каждую службу можно разрабатывать, обновлять, развертывать и масштабировать отдельно от остальных. Обновления можно выполнять чаще, повышая надежность, время бесперебойной работы и производительность программного обеспечения.  
Кроме того, микросервисы упрощают для команд обновление кода и ускоряют циклы релиза благодаря непрерывной интеграции и непрерывной поставке (CI/CD). Команды могут поэкспериментировать с кодом и вернуться к предыдущей версии, если что-то пойдет не так.  
Таким образом, микросервисы дают следующие преимущества.  
•	Гибкость. Продвигайте гибкие методы работы среди небольших команд, которые регулярно выполняют развертывание.  
•	Гибкое масштабирование. Когда микросервис достигает предельной нагрузки, можно быстро выполнить развертывание новых экземпляров данной службы в сопутствующем кластере и снизить нагрузку.   
•	Непрерывное развертывание. Регулярные и ускоренные циклы релиза.  
•	Легкость обслуживания и тестирования. Команды могут экспериментировать с новыми функциями и возвращаться к предыдущей версии, если что-то не работает. Это упрощает обновление кода и ускоряет выпуск новых функций на рынок. Кроме того, в отдельных службах легко находить и исправлять ошибки и баги.  
•	Независимое развертывание. Микросервисы представляют собой отдельные модули, поэтому с ними можно легко и быстро выполнять независимое развертывание отдельных функций.  
•	Гибкость технологий. При использовании архитектуры микросервисов команды могут выбирать инструменты с учетом своих предпочтений.  
•	Высокая надежность. Развертывая изменения для конкретной службы, можно не бояться, что приложение выйдет из строя целиком.  

### Недостатки микросервисов
Микросервисы могут сделать процесс разработки сложнее и привести к его разрастанию — быстрому и неуправляемому росту. Иногда бывает сложно определить, как различные компоненты связаны друг с другом, кто владеет конкретным программным компонентом или как избежать вмешательства в работу зависимых компонентов.  
К недостаткам микросервисов можно отнести следующие особенности.  
•	Разрастание процесса разработки. Микросервисы усложняют работу по сравнению с монолитной архитектурой, поскольку в различных местах возникает все больше служб, созданных несколькими командами. Если разрастание не контролируется должным образом, оно приводит к замедлению разработки и снижению операционной эффективности.  
•	Экспоненциальный рост расходов на инфраструктуру. У каждого нового микросервиса может быть своя стоимость комплекта тестов, инструкций по развертыванию, инфраструктуры хостинга, инструментов мониторинга и т. д.  
•	Дополнительные организационные расходы. Командам требуется дополнительный уровень коммуникации и сотрудничества, чтобы координировать работу над обновлениями и интерфейсами.  
•	Проблемы при отладке. У каждого микросервиса свой набор журналов, что усложняет отладку. Кроме того, дополнительные затруднения могут возникать в том случае, когда один бизнес-процесс выполняется на нескольких машинах.  
•	Отсутствие стандартизации. Без общей платформы может возникнуть ситуация, в которой расширяется список языков, стандартов ведения журналов и средств мониторинга.  
•	Отсутствие ясности в вопросах владения. По мере появления новых служб увеличивается и количество работающих над ними команд. Со временем становится сложнее определить, какие службы команда может использовать и к кому следует обращаться за поддержкой.

## Отличия микросервисной и монолитной архитектуры
В случае, когда продукт написан в одном файле, это монолит (от слова mono - "один"), и архитектура - монолитная. Когда код разнесен по нескольким файлам, это микросервисная архитектура, а сами файлы - микросервисы (то есть, "маленькие" сервисы, являющиеся частью единого целого).  
В отличие от монолитов, в микросервисной архитектуре приложение строится как набор небольших и слабосвязанных компонентов (микросервисов), которые можно разрабатывать, развертывать и поддерживать независимо друг от друга.

## Для каких решений лучше выбрать микросервисы

Многие проекты начинаются как монолитные, а затем, по мере развития, переходят к архитектуре микросервисов.  
По мере добавления в монолитный проект новых возможностей рано или поздно возникают сложности при работе нескольких разработчиков с единой базой кода. Учащаются конфликты в коде и увеличивается риск того, что при обновлении одной возможности появятся баги в другой, не связанной возможности. Если такие нежелательные ситуации возникают, возможно, настало время обсудить переход на микросервисы.  
Микросервисы могут подойти не всем. Если устаревшее монолитное приложение работает без нареканий, его разрушение может не стоить усилий. Однако архитектура микросервисов может оказаться полезной по мере роста организации и повышения требований к приложениям.

Обратите внимание на параметры проекта:   
•	предметную область,   
•	квалификацию команды,   
•	сроки релиза,   
•	нагруженность проекта,   
•	количество внешних систем, с которыми приложение должно общаться.  

Если на проекте не планируются высокие нагрузки и постоянное добавление взаимодействия с внешними сервисами (платежные системы, банки, внешние хранилища и т.п), лучше выбрать монолит. И наоборот: если система должна работать при любых нагрузках и с большим количеством сервисов, то микросервисная архитектуры обязательна.
## Особенности тестирования монолитных и микросервисных веб-приложений?
### Монолитное:
•	Удобное тестирование. Протестировать монолитное приложение гораздо проще, чем микросервисы или бессерверное. Можно запустить и протестировать приложение на сервере разработчика или в промежуточной среде, а также применить стандартный процесс развертывания для проверки изменений перед запуском приложения в продакшн.   
•	При монолите вам нужно поддерживать только один репозиторий.   
•	Вам также понадобится только один конвейер тестирования и развертывания, что может значительно снизить затраты, поскольку создание, настройка и обслуживание нескольких конвейеров выйдет дороже, ведь нужно будет обеспечить согласованность между ними.   
•	Все данные, используемые приложением, также могут храниться в единой базе данных.  
•	Высокий уровень зависимостей. Единый код означает, что компоненты тесно связаны, и изменения в логике одного модуля или службы сопряжены с гораздо более высоким риском влияния на код и работу других модулей. Порой трудно предсказать последствия для приложения даже после небольших изменений в коде. Поэтому каждое обновление вынуждает повторно тестировать весь продукт.


### Микросервисное:
•	Сложность тестирования. С одной стороны, тестировать отдельные микросервисы проще, с другой, необходимость тестировать каждый сервис по отдельности может значительно усложнить приложение по мере его масштабирования. А необходимость тестировать и поддерживать связь между службами создает дополнительную сложность.  
•	Для каждого микросервиса требуется своя команда разработчиков (хотя одна команда может отвечать и за несколько).   
•	Кроме того, придется наладить и процесс автоматического тестирования и развертывания (CI/CD).   
•	Всё это приводит к более высоким первоначальным затратам.
