## HTTP сообщения
### Определение
**HTTP сообщения** - это обмен данными между сервером и клиентом. Есть два типа сообщений: запросы, отправляемые клиентом, чтобы инициировать реакцию со стороны сервера, и ответы от сервера.
### Типы
- **Запросы (HTTP Requests)** — сообщения, которые отправляются клиентом на сервер, чтобы вызвать выполнение некоторых действий. Зачастую для получения доступа к определенному ресурсу. Основой запроса является HTTP-заголовок.
- **Ответы (HTTP Responses)** — сообщения, которые сервер отправляет в ответ на клиентский запрос.
### Структура
**HTTP запросы и ответы** имеют близкую структуру. Они состоят из:

**1. Стартовая строка (start line)** — используется для описания версии используемого протокола и другой информации — вроде запрашиваемого ресурса или кода ответа. Как можно понять из названия, ее содержимое занимает ровно одну строчку.

**2. HTTP-заголовки (HTTP Headers)** — несколько строчек текста в определенном формате, которые либо уточняют запрос, либо описывают содержимое тела сообщения.

**3. Пустая строка**, которая сообщает, что все метаданные для конкретного запроса или ответа были отправлены.

**4. Произвольного тела**, содержащего пересылаемые с запросом данные (например, содержимое HTML-формы ) или отправляемый в ответ документ. Наличие тела и его размер определяется стартовой строкой и заголовками HTTP.
Стартовую строку вместе с заголовками сообщения HTTP называют головой запроса, а его данные - телом.

### Запросы и ответы HTTP
#### Запросы HTTP
Стартовая строка

HTTP запросы - это сообщения, отправляемые клиентом, чтобы инициировать реакцию со стороны сервера. Их стартовая строка состоит из трёх элементов:
**1.** Метод HTTP, глагол (например, GET, PUT или POST) или существительное (например, HEAD или OPTIONS), описывающие требуемое действие. Например, GET указывает, что нужно доставить некоторый ресурс, а POST означает отправку данных на сервер (для создания или модификации ресурса, или генерации возвращаемого документа).
**2.** Цель запроса, обычно URL, или абсолютный путь протокола, порт и домен обычно характеризуются контекстом запроса. Формат цели запроса зависит от используемого HTTP-метода. Это может быть
- Абсолютный путь, за которым следует '?' и строка запроса. Это самая распространённая форма, называемая исходной формой (origin form) . Используется с методами GET, POST, HEAD, и OPTIONS. POST / HTTP 1.1 GET /background.png HTTP/1.0 HEAD /test.html?query=alibaba HTTP/1.1 OPTIONS /anypage.html HTTP/1.0
- Полный URL - абсолютная форма (absolute form) , обычно используется с GET при подключении к прокси. GET http://developer.mozilla.org/ru/docs/Web/HTTP/Messages HTTP/1.1
- Компонента URL "authority", состоящая из имени домена и (необязательно) порта (предваряемого символом ':'), называется authority form. Используется только с методом CONNECT при установке туннеля HTTP. CONNECT developer.mozilla.org:80 HTTP/1.1
- Форма звёздочки (asterisk form), просто "звёздочка" ('*') используется с методом OPTIONS и представляет сервер. OPTIONS * HTTP/1.1
**3.** Версия HTTP, определяющая структуру оставшегося сообщения, указывая, какую версию предполагается использовать для ответа.

**Заголовки**

**Заголовки запроса HTTP** имеют стандартную для заголовка HTTP структуру: не зависящая от регистра строка, завершаемая (':') и значение, структура которого определяется заголовком. Весь заголовок, включая значение, представляет собой одну строку, которая может быть довольно длинной.

Существует множество заголовков запроса. Их можно разделить на несколько групп:
- Основные заголовки (General headers), например, Via (en-US), относящиеся к сообщению в целом
- Заголовки запроса (Request headers), например, User-Agent, Accept-Type, уточняющие запрос (как, например, Accept-Language), придающие контекст (как Referer), или накладывающие ограничения на условия (like If-None).
- Заголовки сущности, например Content-Length, относящиеся к телу сообщения. Как легко понять, они отсутствуют, если у запроса нет тела.

**Тело**

Последней частью запроса является его **тело**. Оно бывает не у всех запросов: запросы, собирающие (fetching) ресурсы, такие как GET, HEAD, DELETE, или OPTIONS, в нем обычно не нуждаются. Но некоторые запросы отправляют на сервер данные для обновления, как это часто бывает с запросами POST (содержащими данные HTML-форм).

Тела можно грубо разделить на две категории:
- Одноресурсные тела (Single-resource bodies), состоящие из одного отдельного файла, определяемого двумя заголовками: Content-Type и Content-Length.
- Многоресурсные тела (Multiple-resource bodies), состоящие из множества частей, каждая из которых содержит свой бит информации. Они обычно связаны с HTML-формами.


#### Ответы HTTP
**Строка статуса (Status line)**

**Стартовая строка ответа HTTP**, называемая строкой статуса, содержит следующую информацию:
- Версию протокола, обычно HTTP/1.1.
- Код состояния (status code), показывающая, был ли запрос успешным. Примеры: 200, 404 или 302
- Пояснение (status text). Краткое текстовое описание кода состояния, помогающее пользователю понять сообщение HTTP..

**Заголовки**

**Заголовки** ответов HTTP имеют ту же структуру, что и все остальные заголовки: не зависящая от регистра строка, завершаемая двоеточием (':') и значение, структура которого определяется типом заголовка. Весь заголовок, включая значение, представляет собой одну строку.

Существует множество заголовков ответов. Их можно разделить на несколько групп:
- Основные заголовки (General headers), например, Via (en-US), относящиеся к сообщению в целом.
- Заголовки ответа (Response headers), например, Vary и Accept-Ranges, сообщающие дополнительную информацию о сервере, которая не уместилась в строку состояния.
- Заголовки сущности (Entity headers), например, Content-Length, относящиеся к телу ответа. Отсутствуют, если у запроса нет тела.

**Тело**

Последней частью ответа является его **тело**. Оно есть не у всех ответов: у ответов с кодом состояния, например, 201 или 204, оно обычно отсутствует.

Тела можно разделить на три категории:
- Одноресурсные тела (Single-resource bodies), состоящие из отдельного файла известной длины, определяемые двумя заголовками: Content-Type и Content-Length.
- Одноресурсные тела (Single-resource bodies), состоящие из отдельного файла неизвестной длины, разбитого на небольшие части (chunks) с заголовком Transfer-Encoding (en-US), значением которого является chunked.
- Многоресурсные тела (Multiple-resource bodies), состоящие из многокомпонентного тела, каждая часть которого содержит свой сегмент информации. Они относительно редки.

### Пример:

**Запрос от браузера:**
GET / HTTP/1.1
Host: webkyrs.info
User-Agent: Mozilla/5.0 (Windows NT 6.1; rv:18.0) Gecko/20100101 Firefox/18.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: ru-RU,ru;q=0.8,en-US;q=0.5,en;q=0.3
Accept-Encoding: gzip, deflate
Cookie: wp-settings
Connection: keep-alive

**В следующем примере уже присутствует тело сообщения.**
**Ответ сервера:**
HTTP/1.1 200 OK
Date: Sun, 10 Feb 2013 03:51:41 GMT
Content-Type: text/html; charset=UTF-8
Transfer-Encoding: chunked
Connection: keep-alive
Keep-Alive: timeout=5
Server: Apache
X-Pingback: //webkyrs.info/xmlrpc.php
 
```<!DOCTYPE html PUBLIC «-//W3C//DTD XHTML 1.0 Transitional//EN» «http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd»>
<html xmlns=»http://www.w3.org/1999/xhtml»>
<head>
<meta http-equiv=»Content-Type» content=»text/html; charset=utf-8″ />
<title>Документ без названия</title>
</head>
<body>
</body>
</html>
```
## HTTP методы
**1. GET** - метод HTTP-запроса, который используется для запроса ресурса с сервера. В этом запросе клиент передает информацию о ресурсе, который он хочет получить, в виде URL-адреса. Сервер возвращает запрошенный ресурс в ответе.

**2. POST** - метод HTTP-запроса, который используется для отправки данных на сервер. В этом запросе клиент передает данные в теле запроса, которые сервер может использовать для обработки запроса и выполнения дальнейших действий.

**3. PUT** - метод HTTP-запроса, который используется для обновления существующего ресурса на сервере. В этом запросе клиент передает данные в теле запроса, которые сервер использует для обновления ресурса.

**4. PATCH** - метод HTTP-запроса, который используется для частичного обновления существующего ресурса на сервере. В этом запросе клиент передает измененные данные в теле запроса, которые сервер использует для обновления соответствующих частей ресурса.

**5. DELETE** - метод HTTP-запроса, который используется для удаления ресурса на сервере. В этом запросе клиент передает информацию о ресурсе, который нужно удалить, в виде URL-адреса. Сервер удаляет указанный ресурс и возвращает ответ.

**6. HEAD** - метод HTTP-запроса, который используется для получения ответа только с заголовками HTTP-ответа, но без тела ответа. В этом запросе сервер возвращает только HTTP-заголовки, которые содержат метаданные о запрошенном ресурсе.

**7. OPTIONS** - метод HTTP-запроса, который используется для получения списка поддерживаемых сервером методов HTTP-запросов для определенного ресурса. В этом запросе сервер возвращает список поддерживаемых HTTP-методов и другие параметры для указанного ресурса.

**8. CONNECT** - метод HTTP-запроса, который используется для установления сетевого соединения с сервером. Этот метод используется для работы с прокси-серверами, которые требуют установки соединения перед отправкой реального запроса.

**9. TRACE** - метод HTTP-запроса, который используется для получения полной копии запроса, отправленного клиентом, в виде ответа от сервера. Этот метод может использоваться для отладки приложений, чтобы получить информацию о том, какие запросы были отправлены и как они были обработаны сервером.

**10. SEARCH** - метод HTTP-запроса, который используется для поиска ресурсов на сервере. Этот метод может использоваться для выполнения различных операций поиска, например, поиск по ключевым словам или поиска с использованием фильтров.

**11. COPY** - метод HTTP-запроса, который используется для создания копии существующего ресурса на сервере. В этом запросе клиент передает информацию о ресурсе, который нужно скопировать, и информацию о новом местоположении копии.

**12. MOVE** - метод HTTP-запроса, который используется для перемещения существующего ресурса на сервере. В этом запросе клиент передает информацию о ресурсе, который нужно переместить, и информацию о новом местоположении ресурса.


